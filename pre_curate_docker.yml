resources:
  - name:       curatedocker
    type:       IncomingWebhook
    configuration:
      webhookName: curate_docker

pipelines:
  - name: CurateDocker
    steps:
    - name: ExampleStep
      type: Bash
      configuration:
        integrations:
          - name: artifactory
        inputResources:
          - name: curatedocker
      execution:
          onExecute:
            - echo `echo "${int_artifactory_url}" | sed -E 's/.*\/\/([^\/]+).*/\1/'`  ${int_artifactory_user} 
            - docker login -u `echo "${int_artifactory_user}"` -p `echo "${int_artifactory_apikey}"` `echo "${int_artifactory_url}" | sed -E 's/.*\/\/([^\/]+).*/\1/'`
            - echo "$res_curatedocker_payload" | jq '.' > payload.json
            - echo "$res_curatedocker_payload"
            - echo `read_json payload.json "image"`
            - cat payload.json | echo
            - docker pull `read_json payload.json "image"`

